<%@ page language="java" contentType="text/html; charset=ISO-8859-1" pageEncoding="ISO-8859-1"%>
<%@taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@taglib uri="http://java.sun.com/jsp/jstl/xml" prefix="x"%>
<%@taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt"%>
<html>
<head>
	<title>Parsing employees.xml</title>
	<style>th {text-align:left}</style>
</head>
<body>
	<c:import url="employees.xml" var="employeeData"/>
	<x:parse xml="${employeeData}" var="dom"/>
	
	
	<!-- Testing purposes -->
	<x:out select="$dom/employees/employee[1]/name" />
	<x:if select="$dom/employees/employee[5]/name" >
		<p><x:out select="$dom/employees/employee[5]/name" /> : name 5 exists</p>
	</x:if>
	
	<x:forEach var="employee" select="$dom/employees/employee">	
		<x:out select="$employee/name"/>
		<x:out select="$employee/jobTitle"/>
		<x:out select="$employee/department"/>
		<x:out select="$employee/salary"/>				
	</x:forEach>
	
	<x:choose>
		<x:when select="$dom/employees/employee[1]/salary>50000">
			salary = 50000
		</x:when>
	</x:choose>

	<!-- Testing purposes -->
	<h2>Displaying All Employees</h2>
	<table border="1">
		<tr>
			<th colspan="4">All Employees in 'employees.xml' File</th>
		</tr>
		<tr>
			 <th>Name</th>
			 <th>Job Title</th>
			 <th>Department</th>
			 <th>Salary</th>
		</tr>
		<x:forEach var="employee" select="$dom/employees/employee">
		<tr>
		  	<td><x:out select="$employee/name"/></td>
			<td><x:out select="$employee/jobTitle"/></td>
			<td><x:out select="$employee/department"/></td>
			<td><x:out select="$employee/salary"/></td>
			
		</x:forEach>
	</table>
	
    
	<h2>Displaying JSTL Functions</h2>
	<table border="1">
	    <tr>
	        <th colspan="4">Employees with >50000 Salary in Green <=50000 Salary in Red</th>
	    </tr>
	    <tr>
	        <th>Name</th>
	        <th>Job Title</th>
	        <th>Department</th>
	        <th>Salary</th>
	    </tr>
	    <x:forEach var="employee" select="$dom/employees/employee">
	        <tr>
	            <x:choose>
	                <x:when select="$employee/salary>50000">
	                	<td style="background-color: #BDFCB1;"><x:out select="$employee/name"/></td>
			            <td style="background-color: #BDFCB1;"><x:out select="$employee/jobTitle"/></td>
			            <td style="background-color: #BDFCB1;"><x:out select="$employee/department"/></td>
			            <td style="background-color: #BDFCB1;"><x:out select="$employee/salary"/></td>
	                </x:when>
	                <x:when select="$employee/salary<=50000">
	                	<td style="background-color: #FFC0C0;"><x:out select="$employee/name"/></td>
			            <td style="background-color: #FFC0C0;"><x:out select="$employee/jobTitle"/></td>
			            <td style="background-color: #FFC0C0;"><x:out select="$employee/department"/></td>
			            <td style="background-color: #FFC0C0;"><x:out select="$employee/salary"/></td>
	                </x:when>
	                <x:otherwise>
	                    <td><x:out select="$employee/name"/></td>
			            <td><x:out select="$employee/jobTitle"/></td>
			            <td><x:out select="$employee/department"/></td>
			            <td><x:out select="$employee/salary"/></td>
	                </x:otherwise>
	            </x:choose>
	        </tr>
	    </x:forEach>
	</table>
    <br>
    <table border="1">
	    <tr>
	        <th colspan="4">Employees with Department = 'Engineering'</th>
	    </tr>
	    <tr>
	        <th>Name</th>
	        <th>Job Title</th>
	        <th>Department</th>
	        <th>Salary</th>
	    </tr>
	    <x:forEach var="employee" select="$dom/employees/employee">
	        <x:choose>
	            <x:when select="$employee/department='Engineering'">
	                <tr>
	                    <td><x:out select="$employee/name"/></td>
	                    <td><x:out select="$employee/jobTitle"/></td>
	                    <td><x:out select="$employee/department"/></td>
	                    <td><x:out select="$employee/salary"/></td>
	                </tr>
	            </x:when>
	        </x:choose>
	    </x:forEach>
	</table>
	<br>
	<table border="1">
	    <tr>
	        <th colspan="4">Employees with Department = 'Finance' or 'Marketing'</th>
	    </tr>
	    <tr>
	        <th>Name</th>
	        <th>Job Title</th>
	        <th>Department</th>
	        <th>Salary</th>
	    </tr>
	    <x:forEach var="employee" select="$dom/employees/employee">
	        <x:choose>
	            <x:when select="$employee/department='Finance' or $employee/department='Marketing'">
	                <tr>
	                    <td><x:out select="$employee/name"/></td>
	                    <td><x:out select="$employee/jobTitle"/></td>
	                    <td><x:out select="$employee/department"/></td>
	                    <td><x:out select="$employee/salary"/></td>
	                </tr>
	            </x:when>
	        </x:choose>
	    </x:forEach>
	</table>
	
</body>
</html>